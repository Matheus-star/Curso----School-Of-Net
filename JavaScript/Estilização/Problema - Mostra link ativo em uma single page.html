<!doctype html>
<html>
    <head>
        <title>Javascript Completo</title>
        <meta charset="utf-8">
        
        <style type="text/css">

            body{
                font: 100%/2 sans-serif;
            }
        
            .nav{
                position: fixed;
                width: 150px;
                top: 25px;
                left: 10px;
                border: 1px solid #ccc;
            }

            .content{
                margin-left: 165px;
            }

            .nav ul{
                margin: 0;
                padding: 0;
                list-style: none;
            }
            .nav li{
                background: #ddd;
                
            }
            .nav li + li{
                margin-top: 2px;
            }
            .nav a{
                display: block;
                padding: 10px;
            }
            .nav a.actived{
                background: orange;
            }

	    </style>
        
    </head>
    <body>
       
             
       
        <h1>
             Em uma página long scrolling de navegação interna, 
             identificar (destacar) no menu principal (fixo no da página)
             a seção atual enquanto o usuário scrolla a página.
        </h1>
        
        
        <nav class="nav">
            <ul>
                <li><a href="#s1">link 1</a></li>
                <li><a href="#s2">link 2</a></li>
                <li><a href="#s3">link 3</a></li>
            </ul>
        </nav>

        <main class="content">

            <h1>Javascript Completo</h1>

            <h2 id="s1">secao 1</h2>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <h2 id="s2">secao 2</h2>

            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            
            <h2 id="s3">secao 3</h2>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>      
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>

        </main>
        
        <script>
            (function(){

                window.addEventListener('scroll',  destacaMenu);
                let $menu = document.querySelector('.nav');
                let $links = document.querySelectorAll('li a');

                function destacaMenu() {
                    let position = [];
                    for(var i = 0; i < $links.length; i++){
                        position[i] = getPosicao($links[i]);
                    }
                 //   console.log(position);

                    let linkAtual = pegaUltimoLink(position);
                    
                    let linkActive = $menu.querySelector('.actived');
                    if(!!linkActive) linkActive.classList.remove('actived');
                    linkAtual.classList.add('actived');
                }
                
                function getPosicao(link) {
                    let alvo = document.querySelector(link.getAttribute('href'));
                    let positionYViewport = alvo.getBoundingClientRect().top;
                    return positionYViewport;
                    
                }

                function pegaUltimoLink(position) {
                             
                    let qtd = position.length;
      
                    
                    while (qtd) {
                         qtd--;
                        if (position[qtd] < innerHeight / 2) {
                            return $links[qtd];
                        }
                    }
                    return $links[0];
                }
                destacaMenu(); 
            })()
        
        
        </script>
        
    </body>
</html>